<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>French Verbs Flashcard Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #eff6ff 0%, #e0e7ff 100%);
            min-height: 100vh;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1rem;
        }
        
        .header {
            text-align: center;
            margin-bottom: 2rem;
            padding-top: 2rem;
        }
        
        .title {
            font-size: 2.5rem;
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 1rem;
        }
        
        .stats {
            display: flex;
            justify-content: center;
            gap: 2rem;
            font-size: 0.875rem;
            color: #4b5563;
            flex-wrap: wrap;
        }
        
        .stat-item {
            background: white;
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        
        .game-container {
            max-width: 28rem;
            margin: 0 auto;
        }
        
        .card-container {
            position: relative;
            height: 20rem;
            margin-bottom: 2rem;
            cursor: pointer;
            perspective: 1000px;
        }
        
        .card-flip {
            transform-style: preserve-3d;
            transition: transform 0.6s;
            width: 100%;
            height: 100%;
            position: relative;
        }
        
        .card-flip.flipped {
            transform: rotateY(180deg);
        }
        
        .card-front, .card-back {
            backface-visibility: hidden;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            border-radius: 0.75rem;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 1.5rem;
        }
        
        .card-front {
            border: 4px solid #bfdbfe;
        }
        
        .card-back {
            transform: rotateY(180deg);
            border: 4px solid #bbf7d0;
        }
        
        .card-content {
            text-align: center;
        }
        
        .card-label {
            font-size: 0.875rem;
            color: #6b7280;
            margin-bottom: 0.5rem;
        }
        
        .french-text {
            font-size: 1.875rem;
            font-weight: bold;
            color: #1e40af;
        }
        
        .russian-text {
            font-size: 1.5rem;
            font-weight: bold;
            color: #166534;
        }
        
        .controls {
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .controls h3 {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1rem;
            text-align: center;
            color: #1f2937;
        }
        
        .button {
            width: 100%;
            font-weight: 600;
            padding: 0.75rem 1rem;
            border-radius: 0.5rem;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 0.75rem;
            font-size: 1rem;
        }
        
        .button:last-child {
            margin-bottom: 0;
        }
        
        .btn-blue {
            background: #3b82f6;
            color: white;
        }
        
        .btn-blue:hover {
            background: #2563eb;
        }
        
        .btn-yellow {
            background: #eab308;
            color: white;
        }
        
        .btn-yellow:hover {
            background: #ca8a04;
        }
        
        .btn-green {
            background: #22c55e;
            color: white;
        }
        
        .btn-green:hover {
            background: #16a34a;
        }
        
        .instructions {
            background: #f3f4f6;
            border-radius: 0.5rem;
            padding: 1rem;
            font-size: 0.875rem;
            color: #374151;
        }
        
        .instructions h4 {
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .instructions ul {
            list-style-type: disc;
            margin-left: 1.25rem;
        }
        
        .instructions li {
            margin-bottom: 0.25rem;
        }
        
        .kbd {
            background: #e5e7eb;
            padding: 0.125rem 0.25rem;
            border-radius: 0.25rem;
            font-family: monospace;
            font-size: 0.75rem;
        }
        
        .game-over {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .game-over.hidden {
            display: none;
        }
        
        .game-over-content {
            background: white;
            border-radius: 0.75rem;
            padding: 2rem;
            text-align: center;
            max-width: 28rem;
            margin: 0 1rem;
        }
        
        .game-over-emoji {
            font-size: 4rem;
            margin-bottom: 1rem;
        }
        
        .game-over-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 1rem;
        }
        
        .game-over-text {
            color: #6b7280;
            margin-bottom: 1.5rem;
        }
        
        .text-blue { color: #2563eb; }
        .text-green { color: #16a34a; }
        
        .add-words {
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .add-words h3 {
            font-size: 1.125rem;
            font-weight: 600;
            margin-bottom: 1rem;
            color: #1f2937;
        }
        
        .textarea {
            width: 100%;
            min-height: 100px;
            padding: 0.75rem;
            border: 2px solid #e5e7eb;
            border-radius: 0.5rem;
            font-family: monospace;
            font-size: 0.875rem;
            resize: vertical;
            margin-bottom: 0.75rem;
        }
        
        .textarea:focus {
            outline: none;
            border-color: #3b82f6;
        }
        
        .input-help {
            font-size: 0.75rem;
            color: #6b7280;
            margin-bottom: 0.75rem;
        }
        
        .btn-purple {
            background: #8b5cf6;
            color: white;
        }
        
        .btn-purple:hover {
            background: #7c3aed;
        }
        
        .btn-red {
            background: #ef4444;
            color: white;
        }
        
        .btn-red:hover {
            background: #dc2626;
        }
        
        .storage-controls {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }
        
        .storage-controls .button {
            flex: 1;
            margin-bottom: 0;
            min-width: 120px;
        }
        
        @media (max-width: 640px) {
            .title {
                font-size: 2rem;
            }
            
            .stats {
                gap: 1rem;
            }
            
            .card-container {
                height: 16rem;
            }
            
            .french-text {
                font-size: 1.5rem;
            }
            
            .russian-text {
                font-size: 1.25rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1 class="title">üá´üá∑ French Verbs Flashcards</h1>
            <div class="stats">
                <div class="stat-item">
                    <span><strong>Cards left:</strong></span> <span id="cardsLeft" class="text-blue">87</span>
                </div>
                <div class="stat-item">
                    <span><strong>Known:</strong></span> <span id="knownCount" class="text-green">0</span>
                </div>
            </div>
        </div>

        <!-- Game Container -->
        <div class="game-container">
            <!-- Card -->
            <div id="cardContainer" class="card-container">
                <div id="flashcard" class="card-flip">
                    <!-- Front (French) -->
                    <div class="card-front">
                        <div class="card-content">
                            <div class="card-label">French Verb</div>
                            <div id="frenchWord" class="french-text">Click to start!</div>
                        </div>
                    </div>
                    <!-- Back (Russian) -->
                    <div class="card-back">
                        <div class="card-content">
                            <div class="card-label">Russian Translation</div>
                            <div id="russianWord" class="russian-text">–ü–µ—Ä–µ–≤–æ–¥</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Add Words Section -->
            <div class="add-words">
                <h3>Add New Words</h3>
                <textarea id="newWordsInput" class="textarea" placeholder="Enter words in format: french-word[TAB]translation&#10;Example:&#10;bonjour	hello&#10;merci	thank you"></textarea>
                <div class="input-help">
                    Format: french-word[TAB]translation (one pair per line)
                </div>
                <div class="storage-controls">
                    <button id="addWordsBtn" class="button btn-purple">
                        ‚ûï Add Words
                    </button>
                    <button id="resetBtn" class="button btn-red">
                        üîÑ Reset All
                    </button>
                </div>
            </div>

            <!-- Controls -->
            <div class="controls">
                <h3>Controls</h3>
                <button id="flipBtn" class="button btn-blue">
                    üîÑ Flip Card (Space)
                </button>
                <button id="nextBtn" class="button btn-yellow">
                    ‚è≠Ô∏è Next Card (N)
                </button>
                <button id="knowBtn" class="button btn-green">
                    ‚úÖ I Know This (K)
                </button>
            </div>

            <!-- Instructions -->
            <div class="instructions">
                <h4>How to play:</h4>
                <ul>
                    <li>Click the card or press <span class="kbd">Space</span> to flip and see translation</li>
                    <li>Press <span class="kbd">N</span> to move current word to end of queue</li>
                    <li>Press <span class="kbd">K</span> if you know the word (removes from queue)</li>
                </ul>
            </div>
        </div>

        <!-- Game Over Screen -->
        <div id="gameOver" class="game-over hidden">
            <div class="game-over-content">
                <div class="game-over-emoji">üéâ</div>
                <h2 class="game-over-title">Congratulations!</h2>
                <p class="game-over-text">You've learned all 87 French verbs!</p>
                <button id="restartBtn" class="button btn-blue">
                    Start Over
                </button>
            </div>
        </div>
    </div>

    <script>
        // Vocabulary data
        const verbs = [
            {french: "abandonner", russian: "–±—Ä–æ—Å–∞—Ç—å, –æ—Å—Ç–∞–≤–ª—è—Ç—å"},
            {french: "accorder", russian: "–ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å, –¥–∞–≤–∞—Ç—å"},
            {french: "adapter", russian: "–∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å, –ø—Ä–∏—Å–ø–æ—Å–∞–±–ª–∏–≤–∞—Ç—å"},
            {french: "adopter", russian: "–ø—Ä–∏–Ω–∏–º–∞—Ç—å, —É—Å–≤–∞–∏–≤–∞—Ç—å"},
            {french: "aider", russian: "–ø–æ–º–æ–≥–∞—Ç—å"},
            {french: "aimer", russian: "–ª—é–±–∏—Ç—å"},
            {french: "aller", russian: "–∏–¥—Ç–∏, –µ—Ö–∞—Ç—å"},
            {french: "am√©liorer", russian: "—É–ª—É—á—à–∞—Ç—å"},
            {french: "ancrer", russian: "–∑–∞–∫—Ä–µ–ø–ª—è—Ç—å"},
            {french: "apprendre", russian: "–∏–∑—É—á–∞—Ç—å, —É—á–∏—Ç—å—Å—è"},
            {french: "approcher", russian: "–ø—Ä–∏–±–ª–∏–∂–∞—Ç—å—Å—è"},
            {french: "atteindre", russian: "–¥–æ—Å—Ç–∏–≥–∞—Ç—å"},
            {french: "avoir", russian: "–∏–º–µ—Ç—å"},
            {french: "commander", russian: "–∑–∞–∫–∞–∑—ã–≤–∞—Ç—å"},
            {french: "commettre", russian: "—Å–æ–≤–µ—Ä—à–∞—Ç—å"},
            {french: "comprendre", russian: "–ø–æ–Ω–∏–º–∞—Ç—å"},
            {french: "concerner", russian: "–∫–∞—Å–∞—Ç—å—Å—è"},
            {french: "conna√Ætre", russian: "–∑–Ω–∞—Ç—å"},
            {french: "conseiller", russian: "—Å–æ–≤–µ—Ç–æ–≤–∞—Ç—å"},
            {french: "continuer", russian: "–ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å"},
            {french: "cr√©er", russian: "—Å–æ–∑–¥–∞–≤–∞—Ç—å"},
            {french: "demander", russian: "—Å–ø—Ä–∞—à–∏–≤–∞—Ç—å"},
            {french: "d√©pendre", russian: "–∑–∞–≤–∏—Å–µ—Ç—å"},
            {french: "d√©tester", russian: "–Ω–µ–Ω–∞–≤–∏–¥–µ—Ç—å"},
            {french: "d√©velopper", russian: "—Ä–∞–∑–≤–∏–≤–∞—Ç—å"},
            {french: "devoir", russian: "–±—ã—Ç—å –¥–æ–ª–∂–Ω—ã–º"},
            {french: "dire", russian: "–≥–æ–≤–æ—Ä–∏—Ç—å"},
            {french: "donner", russian: "–¥–∞–≤–∞—Ç—å"},
            {french: "√©couter", russian: "—Å–ª—É—à–∞—Ç—å"},
            {french: "√©crire", russian: "–ø–∏—Å–∞—Ç—å"},
            {french: "entendre", russian: "—Å–ª—ã—à–∞—Ç—å"},
            {french: "entretenir", russian: "–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å"},
            {french: "esp√©rer", russian: "–Ω–∞–¥–µ—è—Ç—å—Å—è"},
            {french: "essayer", russian: "–ø—ã—Ç–∞—Ç—å—Å—è"},
            {french: "√©tudier", russian: "–∏–∑—É—á–∞—Ç—å"},
            {french: "√©viter", russian: "–∏–∑–±–µ–≥–∞—Ç—å"},
            {french: "exercer", russian: "—É–ø—Ä–∞–∂–Ω—è—Ç—å"},
            {french: "exister", russian: "—Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å"},
            {french: "exprimer", russian: "–≤—ã—Ä–∞–∂–∞—Ç—å"},
            {french: "faire", russian: "–¥–µ–ª–∞—Ç—å"},
            {french: "finir", russian: "–∑–∞–∫–∞–Ω—á–∏–≤–∞—Ç—å"},
            {french: "fixer", russian: "—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å"},
            {french: "fonctionner", russian: "—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞—Ç—å"},
            {french: "forger", russian: "–∫–æ–≤–∞—Ç—å"},
            {french: "fuir", russian: "–±–µ–∂–∞—Ç—å"},
            {french: "garder", russian: "—Ö—Ä–∞–Ω–∏—Ç—å"},
            {french: "habiter", russian: "–∂–∏—Ç—å"},
            {french: "habituer", russian: "–ø—Ä–∏–≤—ã–∫–∞—Ç—å"},
            {french: "identifier", russian: "–æ–ø—Ä–µ–¥–µ–ª—è—Ç—å"},
            {french: "imaginer", russian: "–≤–æ–æ–±—Ä–∞–∂–∞—Ç—å"},
            {french: "int√©grer", russian: "–∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å"},
            {french: "int√©resser", russian: "–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞—Ç—å"},
            {french: "inviter", russian: "–ø—Ä–∏–≥–ª–∞—à–∞—Ç—å"},
            {french: "lire", russian: "—á–∏—Ç–∞—Ç—å"},
            {french: "maltraiter", russian: "–ø–ª–æ—Ö–æ –æ–±—Ä–∞—â–∞—Ç—å—Å—è"},
            {french: "manquer", russian: "–Ω–µ —Ö–≤–∞—Ç–∞—Ç—å"},
            {french: "mesurer", russian: "–∏–∑–º–µ—Ä—è—Ç—å"},
            {french: "n√©gliger", russian: "–ø—Ä–µ–Ω–µ–±—Ä–µ–≥–∞—Ç—å"},
            {french: "nourrir", russian: "–ø–∏—Ç–∞—Ç—å"},
            {french: "obtenir", russian: "–ø–æ–ª—É—á–∞—Ç—å"},
            {french: "oublier", russian: "–∑–∞–±—ã–≤–∞—Ç—å"},
            {french: "para√Ætre", russian: "–∫–∞–∑–∞—Ç—å—Å—è"},
            {french: "parler", russian: "–≥–æ–≤–æ—Ä–∏—Ç—å"},
            {french: "participer", russian: "—É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å"},
            {french: "passer", russian: "–ø—Ä–æ—Ö–æ–¥–∏—Ç—å"},
            {french: "payer", russian: "–ø–ª–∞—Ç–∏—Ç—å"},
            {french: "permettre", russian: "–ø–æ–∑–≤–æ–ª—è—Ç—å"},
            {french: "pers√©v√©rer", russian: "—É–ø–æ—Ä—Å—Ç–≤–æ–≤–∞—Ç—å"},
            {french: "personnaliser", russian: "–ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å"},
            {french: "pouvoir", russian: "–º–æ—á—å"},
            {french: "pratiquer", russian: "–ø—Ä–∞–∫—Ç–∏–∫–æ–≤–∞—Ç—å"},
            {french: "prendre", russian: "–±—Ä–∞—Ç—å"},
            {french: "pr√©senter", russian: "–ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è—Ç—å"},
            {french: "privil√©gier", russian: "–æ—Ç–¥–∞–≤–∞—Ç—å –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–µ"},
            {french: "progresser", russian: "–ø—Ä–æ–≥—Ä–µ—Å—Å–∏—Ä–æ–≤–∞—Ç—å"},
            {french: "profiter", russian: "–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è"},
            {french: "recommander", russian: "—Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞—Ç—å"},
            {french: "redoubler", russian: "—É–¥–≤–∞–∏–≤–∞—Ç—å"},
            {french: "regarder", russian: "—Å–º–æ—Ç—Ä–µ—Ç—å"},
            {french: "r√©p√©ter", russian: "–ø–æ–≤—Ç–æ—Ä—è—Ç—å"},
            {french: "rester", russian: "–æ—Å—Ç–∞–≤–∞—Ç—å—Å—è"},
            {french: "r√©sister", russian: "—Å–æ–ø—Ä–æ—Ç–∏–≤–ª—è—Ç—å—Å—è"},
            {french: "r√©ussir", russian: "—É–¥–∞–≤–∞—Ç—å—Å—è"},
            {french: "savoir", russian: "–∑–Ω–∞—Ç—å"},
            {french: "sentir", russian: "—á—É–≤—Å—Ç–≤–æ–≤–∞—Ç—å"},
            {french: "stagner", russian: "–∑–∞—Å—Ç–∞–∏–≤–∞—Ç—å—Å—è"},
            {french: "stresser", russian: "–Ω–µ—Ä–≤–Ω–∏—á–∞—Ç—å"},
            {french: "structurer", russian: "—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞—Ç—å"},
            {french: "suivre", russian: "—Å–ª–µ–¥–æ–≤–∞—Ç—å"},
            {french: "t√¢cher", russian: "—Å—Ç–∞—Ä–∞—Ç—å—Å—è"},
            {french: "travailler", russian: "—Ä–∞–±–æ—Ç–∞—Ç—å"},
            {french: "tromper", russian: "–æ–±–º–∞–Ω—ã–≤–∞—Ç—å"},
            {french: "utiliser", russian: "–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å"},
            {french: "voir", russian: "–≤–∏–¥–µ—Ç—å"},
            {french: "vouloir", russian: "—Ö–æ—Ç–µ—Ç—å"}
        ];

        // Game state
        let gameQueue = [];
        let knownWords = [];
        let allWords = [...verbs];
        let currentCard = null;
        let isFlipped = false;
        let gameStarted = false;

        // Storage keys
        const STORAGE_KEYS = {
            gameQueue: 'frenchCards_gameQueue',
            knownWords: 'frenchCards_knownWords',
            allWords: 'frenchCards_allWords',
            gameStarted: 'frenchCards_gameStarted'
        };

        // DOM elements
        const flashcard = document.getElementById('flashcard');
        const frenchWord = document.getElementById('frenchWord');
        const russianWord = document.getElementById('russianWord');
        const cardsLeft = document.getElementById('cardsLeft');
        const knownCount = document.getElementById('knownCount');
        const cardContainer = document.getElementById('cardContainer');
        const gameOver = document.getElementById('gameOver');
        const restartBtn = document.getElementById('restartBtn');
        const flipBtn = document.getElementById('flipBtn');
        const nextBtn = document.getElementById('nextBtn');
        const knowBtn = document.getElementById('knowBtn');
        const newWordsInput = document.getElementById('newWordsInput');
        const addWordsBtn = document.getElementById('addWordsBtn');
        const resetBtn = document.getElementById('resetBtn');

        // Local Storage functions
        function saveGameState() {
            try {
                localStorage.setItem(STORAGE_KEYS.gameQueue, JSON.stringify(gameQueue));
                localStorage.setItem(STORAGE_KEYS.knownWords, JSON.stringify(knownWords));
                localStorage.setItem(STORAGE_KEYS.allWords, JSON.stringify(allWords));
                localStorage.setItem(STORAGE_KEYS.gameStarted, JSON.stringify(gameStarted));
            } catch (e) {
                console.warn('Could not save game state to localStorage:', e);
            }
        }

        function loadGameState() {
            try {
                const savedQueue = localStorage.getItem(STORAGE_KEYS.gameQueue);
                const savedKnown = localStorage.getItem(STORAGE_KEYS.knownWords);
                const savedAllWords = localStorage.getItem(STORAGE_KEYS.allWords);
                const savedGameStarted = localStorage.getItem(STORAGE_KEYS.gameStarted);

                if (savedQueue) gameQueue = JSON.parse(savedQueue);
                if (savedKnown) knownWords = JSON.parse(savedKnown);
                if (savedAllWords) allWords = JSON.parse(savedAllWords);
                if (savedGameStarted) gameStarted = JSON.parse(savedGameStarted);

                // If no saved data or empty queue, initialize with default verbs
                if (!savedQueue || gameQueue.length === 0) {
                    gameQueue = shuffleArray([...allWords]);
                    gameStarted = false;
                }

                return true;
            } catch (e) {
                console.warn('Could not load game state from localStorage:', e);
                return false;
            }
        }

        function clearGameState() {
            try {
                Object.values(STORAGE_KEYS).forEach(key => {
                    localStorage.removeItem(key);
                });
            } catch (e) {
                console.warn('Could not clear game state from localStorage:', e);
            }
        }

        // Shuffle array function
        function shuffleArray(array) {
            const shuffled = [...array];
            for (let i = shuffled.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
            }
            return shuffled;
        }

        // Initialize game
        function initGame() {
            // Try to load saved state first
            const loaded = loadGameState();
            
            if (!loaded || gameQueue.length === 0) {
                // If no saved state or empty queue, reset to shuffled default verbs
                gameQueue = shuffleArray([...allWords]);
                knownWords = [];
                gameStarted = false;
            }
            
            isFlipped = false;
            flashcard.classList.remove('flipped');
            
            if (gameStarted && gameQueue.length > 0) {
                currentCard = gameQueue[0];
                frenchWord.textContent = currentCard.french;
                russianWord.textContent = currentCard.russian;
            } else {
                frenchWord.textContent = "Click to start!";
                russianWord.textContent = "–ü–µ—Ä–µ–≤–æ–¥";
            }
            
            updateCounters();
            saveGameState();
        }

        // Parse new words from textarea
        function parseNewWords(text) {
            const lines = text.trim().split('\n');
            const newWords = [];
            
            for (let line of lines) {
                line = line.trim();
                if (!line) continue;
                
                const parts = line.split('\t');
                if (parts.length >= 2) {
                    const french = parts[0].trim();
                    const russian = parts.slice(1).join('\t').trim(); // In case translation contains tabs
                    
                    if (french && russian) {
                        // Check if word already exists
                        const exists = allWords.some(word => 
                            word.french.toLowerCase() === french.toLowerCase()
                        );
                        
                        if (!exists) {
                            newWords.push({ french, russian });
                        }
                    }
                }
            }
            
            return newWords;
        }

        // Add new words to the game
        function addNewWords() {
            const inputText = newWordsInput.value;
            if (!inputText.trim()) return;
            
            const newWords = parseNewWords(inputText);
            if (newWords.length === 0) {
                alert('No valid words found. Please check the format:\nfrench-word[TAB]translation');
                return;
            }
            
            // Add to all words
            allWords.push(...newWords);
            
            // Shuffle new words and add to end of queue
            const shuffledNewWords = shuffleArray([...newWords]);
            gameQueue.push(...shuffledNewWords);
            
            // Clear input
            newWordsInput.value = '';
            
            // Update UI and save
            updateCounters();
            saveGameState();
            
            alert(`Added ${newWords.length} new words to the game!`);
        }

        // Reset entire game
        function resetGame() {
            if (confirm('This will reset all progress and remove custom words. Are you sure?')) {
                clearGameState();
                allWords = [...verbs]; // Reset to original verbs only
                gameQueue = shuffleArray([...allWords]);
                knownWords = [];
                gameStarted = false;
                isFlipped = false;
                flashcard.classList.remove('flipped');
                frenchWord.textContent = "Click to start!";
                russianWord.textContent = "–ü–µ—Ä–µ–≤–æ–¥";
                newWordsInput.value = '';
                updateCounters();
                saveGameState();
            }
        }

        // Start game
        function startGame() {
            if (!gameStarted) {
                gameStarted = true;
                nextCard();
            }
        }

        // Show next card
        function nextCard() {
            if (gameQueue.length === 0) {
                showGameOver();
                return;
            }

            currentCard = gameQueue[0];
            isFlipped = false;
            flashcard.classList.remove('flipped');
            frenchWord.textContent = currentCard.french;
            russianWord.textContent = currentCard.russian;
            saveGameState();
        }

        // Flip card
        function flipCard() {
            if (!gameStarted) {
                startGame();
                return;
            }
            
            isFlipped = !isFlipped;
            flashcard.classList.toggle('flipped');
        }

        // Move current word to end of queue
        function moveToEnd() {
            if (!gameStarted || gameQueue.length === 0) return;
            
            const word = gameQueue.shift();
            gameQueue.push(word);
            nextCard();
        }

        // Mark word as known
        function markAsKnown() {
            if (!gameStarted || gameQueue.length === 0) return;
            
            const word = gameQueue.shift();
            knownWords.push(word);
            updateCounters();
            nextCard();
        }

        // Update counters
        function updateCounters() {
            cardsLeft.textContent = gameQueue.length;
            knownCount.textContent = knownWords.length;
        }

        // Show game over screen
        function showGameOver() {
            gameOver.classList.remove('hidden');
        }

        // Restart game
        function restartGame() {
            gameOver.classList.add('hidden');
            // Reset queue from all words (including custom ones)
            gameQueue = shuffleArray([...allWords]);
            knownWords = [];
            gameStarted = false;
            isFlipped = false;
            flashcard.classList.remove('flipped');
            frenchWord.textContent = "Click to start!";
            russianWord.textContent = "–ü–µ—Ä–µ–≤–æ–¥";
            updateCounters();
            saveGameState();
        }

        // Event listeners
        cardContainer.addEventListener('click', flipCard);
        flipBtn.addEventListener('click', flipCard);
        nextBtn.addEventListener('click', moveToEnd);
        knowBtn.addEventListener('click', markAsKnown);
        restartBtn.addEventListener('click', restartGame);
        addWordsBtn.addEventListener('click', addNewWords);
        resetBtn.addEventListener('click', resetGame);

        // Keyboard controls
        document.addEventListener('keydown', (e) => {
            switch(e.key.toLowerCase()) {
                case ' ':
                    e.preventDefault();
                    flipCard();
                    break;
                case 'n':
                    moveToEnd();
                    break;
                case 'k':
                    markAsKnown();
                    break;
            }
        });

        // Initialize game on load
        initGame();
    </script>
</body>
</html>